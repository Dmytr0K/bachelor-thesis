\input{style.tex}
\begin{document}

% Выключить нумерацию на титульной странице
\thispagestyle{empty}

\begin{nospasing}
\begin{center}
    Министерство образования и науки Российской Федерации \\
    Федеральное государственное бюджетное образовательное учреждение \\
    высшего образования \\
    «Волгоградский государственный технический университет» \\
    Факультет электроники и вычислительной техники \\
    Кафедра «Электронно-вычислительные машины и системы» \\

    \begin{flushright}
    На правах рукописи \\
    \end{flushright}

    МАРКОВ АЛЕКСЕЙ ЕВГЕНЬЕВИЧ \\
    \vspace{1cm}
    Разработка метода построения программной траектории и регулятора движения по ней беспилотного
    наземного транспортного средства \\
    \vspace{1cm}
    Магистерская программа \\
    «Высокопроизводительные вычислительные системы» \\
    Направление подготовки 09.04.01 «Информатика и вычислительная техника» \\
    \vspace{1cm}
    АВТОРЕФЕРАТ \\
    \vspace{1cm}
    диссертации на соискание степени \\
    магистра \\

    \vfill

    Волгоград – 2019
\end{center}
\end{nospasing}

\newpage

\begin{nospasing}
\noindent
Работа выполнена на кафедре «Электронно-вычислительные машины и
системы» Волгоградского государственного технического университета\\

\noindent
Научный руководитель:\\

    \setlength{\leftskip}{3cm}
    \noindent
    доктор технических наук, \\
    профессор Горобцов Александр Сергеевич \\

    \setlength{\leftskip}{0pt}

\noindent
Рецензент:

    \setlength{\leftskip}{3cm}
    \noindent
    \hl{TODO} \\

    \setlength{\leftskip}{0pt}

\end{nospasing}

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\referchapter{ОБЩАЯ ХАРАКТЕРИСТИКА РАБОТЫ}
\textbf{Актуальность темы исследования.}

Использование беспилотных систем и интеллектуальных систем помощи водителю (ADAS) на дорогах общего
пользования приведет к повышению безопасности дорожного движения по причине уменьшения человеческого
фактора, увеличению пропускной способности дорог и дорожной инфраструктуры, уменьшению пробок, а также
уменьшить количество личных автомобилей при сохранении текущих сценариев использования, что еще
сильнее снизит нагрузку на инфраструктуру и загрязнение окружающей среды.

На кафедрах ЭВМиС, ВМ и АТ ВолгГТУ в настоящее время ведется разработка прототипа беспилотного
автомобиля на базе автомобиля Лада Калина.

\textbf{Цель и задачи работы.}

Целью данной работы является разработка системы управления движением беспилотного автомобиля.
Для достижения данной цели решались следующие задачи:
\begin{enumerate}
    \item анализ существующих подходов к задаче управления беспилотными автомобилями в целом, выделение
    типичных подсистем,
    \item проектирование подсистем управления движением беспилотным автомобилем,
    \item реализация подсистем управления движением,
    \item проведение экспериментов и оценка результатов работы.
\end{enumerate}

\textbf{Объектом исследования является} процесс управления движением беспилотного автомобиля.

\textbf{Предметом исследования являются} алгоритмы и подходы к реализации системы управления движением
беспилотного автомобиля.

\textbf{Основные положения, выносимые на защиту:}
\begin{enumerate}
    \item подход к локальному планированию траектории движения беспилотного автомобиля с помощью
          полиномов пятого порядка в системе координат Френе \hl{TODO: уточнить перевод Frenet Frame},
    \item разработанная архитектура системы управления беспилотным автомобилем.
\end{enumerate}

\textbf{Научной новизной} работы является \hl{оптимизированная реализация алгоритма локального планирования
    траектории методом интерполяции полиномов пятого порядка на GPU}.
\hl{Вот если успею оптимизировать, значит будет, а если нет - даже не знаю, какая новизна}

\textbf{Практическая ценность} работы заключается в:
\begin{enumerate}
    \item программной реализации системы управления движением беспилотного автомобиля,
    \item \hl{...}
    \item \hl{...}
\end{enumerate}

\textbf{Апробация} работы проводилась \hl{TODO}

\textbf{Публикации.} По материалам диссертации автором \hl{TODO: ничего не было опубликовано}

\textbf{Структура и объем работы}. Диссертационная работа состоит из введения, четырех глав, заключения,
списка использованных источников из \hl{23 (не окончательно)} наименований и насчитывает \hl{TODO} страниц.

\referchapter{ОСНОВНОЕ СОДЕРЖАНИЕ РАБОТЫ}
\textbf{Во введении} обосновывается выбор темы диссертационного исследования и ее актуальность,
определяются цели и задачи работы, объект и предмет исследования, формулируется научная новизна.

\textbf{В первой главе} анализируется типичный применяемый подход к построению систем управления
беспилотными автомобиля и применяемые методы планирования движения. Анализируя источники по данной тематике,
можно сделать вывод, что, несмотря на большое количество архитектур систем управления беспилотными
автомобилями, можно выделить общие архитектурные концепции (рисунок \ref{img:general_arch}).

В общем виде, систему управления беспилотным автомобилем
можно разделить на следующие подсистемы:
\begin{itemize}
    \item интерфейс сенсоров, позволяющий получать данные от сенсоров;
    \item подсистема восприятия (perception), осуществляющая построение комплексной информации об
    окружающем пространстве, на основе данных от сенсоров;
    \item подсистема управления движением,осуществляющая принятие решений и построение безопасной
    и достижимой траектории и осуществляющая движение по траектории, формирования управляющих сигналов,
    таких как угол поворота руля, газ, тормоз.
\end{itemize}

\begin{figure}[h]
    \centering
    \includegraphics[width=\linewidth]{images/general_arch}
    \caption{Обобщенная абстракция архитектуры управления автономными автомобилями}
    \label{img:general_arch}
\end{figure}

Процесс планирования движения и принятия решений в современных беспилотных автомобилях обычно представлен в виде
иерархии: планирование маршрута (route planning), принятие решений (behaviour planning, decision making), локально планирование
(local motion planning) и управление с обратной связью.

На верхнем уровне осуществляется планирование маршрута по дорожной сети. Затем следуют уровень планирования
поведения, который принимает решения и формирует локальные навигационные задачи, которые приближают автомобиль
к выполнению высокоуровневой задачи и удовлетворяют правилам дорожного движения. Затем локальный планировщик
формирует непрерывный кинематически и динамически достижимый путь в обход препятствий в окружающем пространстве, который выполняет локальную навигационную задачу. Система
управления с обратной связью осуществляет выполнение запланированного движения и коррекцию ошибок.

В данной работе основной акцент делается на планировании локального движения. Рассматривается ряд распространенных
методов планирования движения: метод планирования на графах, в частности, метод клеточной декомпозиции, случайные
(sample-based) методы, основанные на алгоритме Rapidly Exploring Random Trees (RRT) и его модификациях, методы
интерполяции траектории с помощью кривых.

\textbf{Во второй главе} рассматривается проектирование системы управления движением беспилотного автомобиля.

Для планирования локальной траектории траектории выбран метод интерполяции кривыми, а именно, полиномами
пятого порядка. Метод интерполяции выбран по причине его детерминированности и возможности находить оптимальное
или близкое к нему решение.

Планирование траектории осуществляется в подвижной системе координат (с.к. Френе \hl{TODO: перевод}),
движущейся по идеальной траектории, как показано на рисунке \ref{img:junior_frenet_frame}. В качестве
идеальной траектории  выступает центр полосы движения. Это является распространенным подходом к
планированию движения и позволяет рассмотреть независимо планирование поперечного движения и
продольного движения (профиля скорости).

\begin{figure}[h]
    \centering
    \includegraphics[width=0.7\textwidth]{images/junior_frenet_frame}
    \caption{Система координат для планирование траектории}
    \label{img:junior_frenet_frame}
\end{figure}

Для нахождения оптимальной траектории, определена функция стоимости, основанная на минимизации рывков
(jerk), т.е. производной ускорения. Такая функция стоимости позволит планировать траектории, избегающие
излишнего количества маневров или резких маневров. Функции стоимости определяются независимо для
поперечного (\ref{eq:cost_lat}) и продольного (\ref{eq:cost_lon}) движения.

\begin{equation}
    \label{eq:cost_lat}
    J_d = k_{jd}\int_0^S{\dddot{d}(s)ds} + k_{sd}S + k_{dd}\big(s(T)\big)^2
\end{equation}
\begin{equation}
    \label{eq:cost_lon}
    J_s = k_{js}\int_0^T{\dddot{s}(t)dt} + k_{ts}T + k_{ss}\big[s_{target} - s(T)\big]^2
\end{equation}

\noindent\begin{tabularx}{\linewidth}{lllX}
    где & $s(t)$         &~---& продольная траектория, \\
        & $d(t)$         &~---& поперечная траектория, \\
        & $T$            &~---& время маневра, \\
        & $s_{target}$   &~---& целевое продольное положение, \\
        & $k_{jd}, k_{sd}, k_{dd}$ &~---& весовые коэффициенты для поперечного движения,\\
        & $k_{js}, k_{ts}, k_{ss}$ &~---& весовые коэффициенты для продольного движения.
\end{tabularx}

При выборе оптимальной траектории необходимо учитывать ограничения на максимальную скорость, ускорение,
угол поворота, накладываемые кинематикой и динамикой автомобиля, а также выбирать траекторию, не
пересекающуюся с препятствиями. Оптимизация с учетом этих ограничений является затруднительной и
типичным подходом является формирование набора траекторий и выбора оптимальной. Происходит формирование
набора траекторий путем варьирования конечных условий, а затем выбор наиболее оптимальной из них,
удовлетворяющей ограничениям. Пример формирования набора траекторий и выбора оптимальной приведен на
рисунке \ref{img:trajectory_planning_example}.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.7\textwidth]{images/trajectory_planning_example}
    \caption{Пример формирования траекторий и выбора оптимальной}
    \label{img:trajectory_planning_example}
\end{figure}

Для реализации этой задачи необходимо было определять начальную оценку времени маневра. Траектории в форме
полиномов пятого порядка определяются начальным $[s(0), \dot{s}(0), \ddot{s}(0)]$ и конечным
$[s(T), \dot{s}(T), \ddot{s}(T)]$ состояниями, а также временем маневра $T$. Аналогичные состояния
используются для формирование поперечных траекторий. Зная начальное и конечное состояние, а также время
маневра, можно найти коэффициенты полинома путем решения системы линейных уравнений из шести уравнений.

Проблема заключается в том, что соблюдать определенная зависимость между начальным, конечным условием и
временем маневра T, для получения подходящей траектории. Пример такого поведения представлен на рисунке
\ref{img:quintic_bad_t}. На этих рисунках представлены продольные положение, скорость и ускорения для автомобиля,
который должен остановиться с начальной скоростью 8 м/с (начальное состояние $[0 m, 8 m/s, 0 m/s^2])$) за
15 метров (конечное состояние $[15 м, 0 m/s, 0 m/s^2]$). Если время маневра выбрано слишком малым
(синия линяя), то полученная в результате расчета траектория будет содержать разгон, а затем еще более резкое торможение. Если время маневра выбрано слишком большим (зеленая линия), то автомобиль проедет дальше
требуемого расстояния, а потом вернется задним ходом. Оба варианта, разумеется, являются неприемлемыми
при планировании движения.

\begin{figure}[h]
    \centering
    \includegraphics[width=1\textwidth]{images/quintic_bad_t}
    \caption{Пример неудачного выбора времени маневра}
    \label{img:quintic_bad_t}
\end{figure}

Существует только одно оптимальное время маневра, но в данном случае мы заинтересованы в формировании
набора конечных условий, чтобы выбрать из них оптимальную итоговую траекторию с учетом различных ограничений.

Поэтому был предложен метод приблизительной оценки времени маневра $T_0$, а затем на его основе сформировать
набор времен $T$ путем варьирования в большую и меньшую сторону:
\begin{equation}
    T \in [T_0 - \Delta T, T_0 + \Delta T]
\end{equation}

В качестве такого приближения предложено равноускоренное движение, описываемое уравнениями
\begin{equation}
    \begin{cases}
    \dot{s}(T) = \dot{s}(0) + aT_0 \\
    s(T) = s_0 + \dot{s}(0)T_0 + \frac{aT_0^2}{2}
    \end{cases}
\end{equation}
\noindent\begin{tabularx}{\linewidth}{lllX}
    где & $s(0), \dot{s}(0)$         &~---& начальное состояние, \\
        & $s(T_0), \dot{s}(T_0)$     &~---& конечное состояние, \\
        & $T_0$                      &~---& время маневра, \\
       & $a$                         &~---& ускорение, не используется.
\end{tabularx}

Решая эту систему, получаем начальную оценку времени маневра $T_0$, которая затем используется для
формирования набора маневров, как показано на рисунке \ref{img:quintic_t_estimate}.

\begin{figure}[h]
    \centering
    \includegraphics[width=1\textwidth]{images/quintic_t_estimate}
    \caption{Формирование набора маневров с помощью начальной оценки}
    \label{img:quintic_t_estimate}
\end{figure}

\hl{В общем, это единственное, что с натяжкой можно назвать новизной}
\\

Для реализации рулевого управления с обратной связью применена упрощенная модель на базе
модель МакАдама.

Управляющий сигнал для рулевого управления получается с помощью пропорционального (П) регулятора
из угла между текущим направлением движения автомобиля (вектором скорости) и направлением на
точку траектории на некотором расстоянии впереди. Это позволяет учитывать будущие изменения
в траектории и реагировать на них заранее.

По причине того, что траектория представлена в виде большого количества плотно расположенных
точек, выбор необходимой точки осуществляется следующим образом: в начале находится ближайшая к автомобилю
точка на кривой, а затем от этой точки вперед по траектории перебираются точки, до тех пор, пока
расстояние от очередной точки до положения автомобиля не будет больше заданного (рисунок \ref{img:path_moving}).

\begin{figure}[h]
    \centering
    \includegraphics[width=0.5\textwidth]{images/path_moving}
    \caption{Пример формирования траекторий и выбора оптимальной}
    \label{img:path_moving}
\end{figure}


\textbf{В третьей главе} представлена реализация системы управления беспилотным автомобилем с
использованием подхода, описанной во второй главе.

Система управления построена на базе Robot Operation System (ROS) ~--- фреймворка для разработки
программного обеспечения для роботов. Использование ROS обладает большим количеством преимуществ
и существенно упрощает процесс разработки ПО:
\begin{itemize}
    \item модульная архитектура, основанная на нодах (nodes), позволяющая разрабатывать
          и тестировать отдельные модули системы независимо,
    \item встроенный удобный механизм межпроцессного взаимодействия (топики и сервисы),
    \item большое количество библиотек, реализующих распространенные в робототехнике алгоритмы,
    \item большое количество библиотек, реализующих работу с распространенным оборудованием,
    \item хорошая документация и сообщество.
\end{itemize}

Был реализован прототип системы управления беспилотным автомобилем и испытан на мобильной
колесной платформе, представленной на рисунке \ref{img:car}.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.5\textwidth]{images/car}
    \caption{Внешний вид колесной платформы}
    \label{img:car}
\end{figure}

В качестве бортового компьютера применена встраиваемая система NVidia Jetson TX2. На платформе размещены
стереокамера ZED Camera и LiDAR Velodyne VLP-16. Стереокамера используется для определения текущего локального
положения и ориентации платформы в пространстве с помощью SLAM-алгоритма, поставляемого с библиотекой
камеры. LiDAR используется для определения препятствий. Т.к. целью данной работы была разработка алгоритмов
движения, разработка полноценной системы компьютерного зрения не проводилась. Применен простейший алгоритм
обнаружения препятствий:
\begin{enumerate}
    \item облако точек, получаемое от LiDAR разбивается с помощью двухмерной регулярной сетки,
    \item за препятствия считаются те клетки сетки, в который присутствует более определенного
          количества точек, чья z-координата превышает заданную.
\end{enumerate}

Архитектура системы управления представлена на рисунке \ref{img:ros_arch}.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{images/ros_arch}
    \caption{Мобильная платформа, используемая в экспериментах}
    \label{img:ros_arch}
\end{figure}

Система управления состоит из четырех основных блоков: блока работы с сенсорами, блока восприятия,
реализующего алгоритмы компьютерного зрения, блока управления движением, реализующего алгоритмы
планирования движения, и блока работы с платформой, управляющего двигателями.

Основными нодами являются motion\_planner\_node и controller\_node, реализующих локальное планирование
траектории и регулятор обратной связью соответственно.

\textbf{В четвертой главе} представлен анализ результатов работы. В рамках диссертационного исследования
была разработана и реализована система управления движением беспилотного автомобиля с использованием
представленного подхода. Алгоритм планирования движения основан на интерполяции траектории с помощью
полиномов пятого порядка, регулирование рулевого управления с обратной связью реализовано на основе
модель МакАдама.

Для оценки работы системы управления беспилотным автомобилем было проведено экспериментальное исследование
с помощью мобильной платформы. Поставленные задачи: определение точности следования по заданной траектории
с помощью регулятора с обратной связью и проверка работы алгоритма планирования траектории.

На рисунке \ref{img:path_moving_test} представлено сравнение программной (оранжевая линия)
и измеренной с помощью SLAM-алгоритма (синия линия) траекторий при движении автомобиля по кругу.
Максимальное отклонение составило примерно 5 см.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.7\textwidth]{images/path_moving_test}
    \caption{Движение по заданной траектории}
    \label{img:path_moving_test}
\end{figure}

На рисунке \ref{img:obstacle_avoidance} представлена визуализация движения с объездом статических
препятствий.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.7\textwidth]{images/obstacle_avoidance}
    \caption{Движение по заданной траектории}
    \label{img:obstacle_avoidance}
\end{figure}

Текущее положение и ориентация модели автомобиля, полученное с помощью SLAM-алгоритма, отмечено
красной стрелкой. Черным и темно-серым отмечены препятствие, определенное с помощью LiDAR и буферная
зона вокруг него соответственно. Зеленая линия отмечает идеальную траекторию, представляющую
середину дороги. В данном эксперименте идеальная траектория представляла собой спираль и считывалась
из файла, в реальности за формирование цели и идеальной траектории отвечает behaviour planner.
Белые линии отмечают виртуальные границы дороги. Многочисленные серые линии ~--- множество
сгенерированных траекторий-кандидатов. Красная линия ~--- выбранная оптимальная траектория
в объезд препятствия.



\textbf{В заключении} работы сформулированы общие выводы о значимости данной работы для
организации и перспективах исследования.

\referchapter{ОСНОВНЫЕ РЕЗУЛЬТАТЫ РАБОТЫ}
\begin{enumerate}
    \item Проведен анализ подходов к построению систем управления беспилотными
          автомобилями, определена общая архитектура и выделены общие блоки.
    \item Проведен анализ методов локального планирования движения для беспилотных автомобилей.
    \item Спроектирован и реализован прототип системы управления движением беспилотного
          автомобиля на базе мобильной платформы.
    \item Проведены испытания на базе мобильной платформы, которые показали возможность
          реализованной системы планировать траекторию движения в объезд препятствий и
          точно следовать запланированной траектории с помощью обратной связи от камеры глубины.

\end{enumerate}

\referchapter{ПЕРСПЕКТИВНЫЕ НАПРАВЛЕНИЯ РАЗВИТИЯ РАБОТЫ}
Данная работа является начальным этапом в исследовании разработке системы управления
беспилотным автомобилем. Дальнейшими шагами в развитии системы управления движения является
реализация алгоритма планирования движения на базе Rapidly Exploring Random Trees и сравнение
его с реализованным алгоритмом на базе полиномов, моделирование поведения автомобиля в
различных дорожных ситуациях для уточнения параметров и алгоритмов планирования движения.

Вторым направлением работ является исследование и разработка системы компьютерного зрения,
которая является важнейшим блоком в архитектуре управления беспилотным автомобилем.

\referchapter{ПУБЛИКАЦИИ ПО ТЕМЕ ДИССЕРТАЦИИ}
\hl{TODO}

\end{document}